---
title: "Marvel At My Universe"
author: "Devesh Kailash Bajaj (MDS202417)"
date: "2024-10-05"
output: 
  pdf_document:
    fig_height: 4
    keep_tex: true
  url_color: "blue"
  geometry: "left=0.1in,right=0.1in,top=0.5cm,bottom=0.5cm"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
	message = FALSE,
	warning = FALSE
)
```

```{r}
library(ggplot2)
library(stringr)
library(knitr)
library(corrplot)
library(gridExtra)
library(dplyr)
```

## Abstract

This project offers an analysis of the Marvel Cinematic Universe (MCU) films, emphasizing the changes in both commercial and critical success throughout the franchise's history. The study examines the MCU's evolution across its various phases and investigates how factors such as cast and director influence a film's success. Additionally, it analyzes the relationship between Metacritic scores and IMDb ratings with the awards won by each movie. Our findings indicate that Marvel films have experienced a significant increase in total gross revenue, along with a consistently improving critical reception. We also observe a strong correlation between Oscar nominations and Metacritic scores, as well as between IMDb ratings and the Gross worldwide revenue generated by these films.

## Introduction:

The Marvel Cinematic Universe (MCU) is one of the largest and the highest-grossing film franchises ever, amassing over \$29.8 billion in revenue. Avengers: Endgame, the 22nd film in the MCU, concluded the decade-long Infinity Stones saga and became the highest-grossing film of all time with \$2.79 billion. This analysis explores the performance of each MCU movie, examining how directors and actors were received by audiences and critics, while also investigating relationships between factors such as budget, revenue, and success metrics to uncover the drivers behind the MCU's remarkable growth.

## Data Description:

The Marvel Cinematic Universe (MCU) dataset contains information on 24 films from the franchise, organized chronologically across phases 1 to 3. The dataset contains the following columns:

```{r}
column_names <- data.frame(
  Column_Names = c("Name", "Budget", "US Release Date", "Domestic Gross", 
                   "Director", "Total Gross", "Producer", "Opening Gross", 
                   "Duration", "Oscar Nomination", "Genre", "Oscar Won", 
                   "IMDB Rating", "Phase", "Metascore", "ROI (Return On Investment)", "Cast"),
  Description = c("The Name of the movie", "The financial budget allocated for the movie(US Dollars)", 
                  "The date the movie was released in the US", "The total gross income from the US(US Dollars)", 
                  "The director(s) of the movie", "The overall gross income of the movie worldwide(US Dollars)", 
                  "The producer(s) of the movie", "The gross income from the opening weekend(US Dollars)", 
                  "The length of the movie", "Number of Oscar nominations received by the movie", 
                  "The category of the movie (e.g., action, drama)", "Number of Oscars won by the movie", 
                  "The rating given by IMDb", "The phase of the Marvel Cinematic Universe to which the movie belongs", 
                  "The Metacritic score of the movie", "The return on investment for the movie", 
                  "A selection of the main actors featured in the films.")
)
kable(column_names, caption = "Column Names and Descriptions")
```

-   **Metascore** is a single number ranging from 0 to 100 that summarizes the critical consensus for a movie. It is calculated by Metacritic, a website that aggregates reviews from a group of respected critics.

-   **Return on Investment (ROI)** is calculated using the total gross and budget provided in the dataset, following the formula: $$
    ROI = \left( \frac{{ \text{{Total Gross}} - \text{{Budget}} }}{{\text{{Budget}}}} \right) \times 100\%
    $$

Additionally, the dataset contains no missing or NA values. The "Budget," "Domestic Gross," "Total Gross," and "Opening Gross" columns represent monetary amounts in U.S. dollars. This data is sourced from the [Marvel Studio Dataset](https://www.kaggle.com/datasets/rachit239/mcu-complete-dataset).

```{r}
## data cleaning
setwd("E:/Bajju files/CMI/VISU")
MCU_Data=read.csv("mcu dataset.csv")
#####################################################################################
convert_duration_to_hours <- function(duration) {
  hours <- as.numeric(str_extract(duration, "\\d+(?=h)"))
  minutes <- as.numeric(str_extract(duration, "\\d+(?=min)"))  
  if (is.na(minutes)){minutes <- 0}
  total_hours <- hours + (minutes / 60)
  return(total_hours)
}
MCU_Data$Duration <- sapply(MCU_Data$Duration, convert_duration_to_hours)
## Converted all entries of the Duration column to a numeric format.

#####################################################################################
Dollars_Col=c("Budget", "Domestic.Gross","Total.Gross","Opening.Gross")
for (column_name in Dollars_Col){
  MCU_Data[[column_name]] <- as.numeric(gsub("[\\$,]", "", MCU_Data[[column_name]]))
}## Converted all entries of columns with currency amounts to a numeric format.

Cols_to_Rename=c("US.release.Date","IMDB.rating","metascore","Domestic.Gross","Total.Gross","Opening.Gross","Oscar.Nomination","Oscar.won")
New_Col_Names=c("US Release Date","IMDB Rating","Metascore","Domestic Gross","Total Gross","Opening Gross","Oscar Nomination","Oscar won")
Col_index=match(Cols_to_Rename,colnames(MCU_Data))
colnames(MCU_Data)[Col_index] <- New_Col_Names

MCU_Data$`IMDB Rating`<- as.numeric(MCU_Data$`IMDB Rating`)
MCU_Data$Metascore <- as.numeric(MCU_Data$Metascore)

## now defining a new column for ROI.
MCU_Data$ROI = ((MCU_Data$'Total Gross' - MCU_Data$Budget) / MCU_Data$Budget) * 100
```

## Exploratory Data Analysis:
We begin by evaluating the performance of the movies over the years using metrics such as IMDb ratings, ROI, and Metascore.Following this, we analyze success trends based on the MCU phase in which each film was released.

```{r, fig.width=10, fig.height=4}
MCU_Data$Name <- factor(MCU_Data$Name, levels = MCU_Data$Name)
###################################################################################################################
## movies vs ROI(phasewise)
movies_vs_Metascore <- ggplot( MCU_Data, aes(x = Name, y = `Metascore`, fill = as.factor(Phase))) +
  geom_bar(stat = "identity", color = "white", size = 0.001) +  #'identity' ensures the bars represent actual values
  coord_cartesian(ylim = c(50, 90)) +
  labs(title = "Movies vs Metascore",
       x = "Movies",
       y = "Metascore",
       fill = "Phase") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1,size=7),
        legend.title = element_text(size = 7),                        
        legend.text = element_text(size = 7),
        legend.position = c(0.2,1),
        legend.direction = "horizontal", 
        legend.justification = c(0.2,1))
  #scale_fill_manual(values = c("chartreuse1", "chartreuse3", "green4"))
###################################################################################################################

## movies_vs_IMDB(phasewise)
movies_vs_IMDB <- ggplot( MCU_Data, aes(x = Name, y = `IMDB Rating`, fill = as.factor(Phase))) +
  geom_bar(stat = "identity", color = "white", size = 0.001) +  #'identity' ensures the bars represent actual values
  coord_cartesian(ylim = c(6, 9)) +
  labs(title = "Movies vs IMDb Ratings",
       x = "Movies",
       y = "IMDb Rating",
       fill = "Phase") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1,size=7),
        legend.title = element_text(size = 7),                        
        legend.text = element_text(size = 7),
        legend.position = c(0.5,1),
        legend.direction = "horizontal", 
        legend.justification = c(0.5,1))
  #scale_fill_manual(values = c("chartreuse1", "chartreuse3", "green4")) 
######################################################################################################################
grid.arrange(movies_vs_IMDB,movies_vs_Metascore,ncol=2)
```

- We observe that the Marvel movie franchise has performed exceptionally well over the years, with consistently strong IMDb ratings and similarly solid Metascores.

```{r, fig.width=8, fig.height=4}
 movies_vs_ROI <- ggplot(MCU_Data, aes(x = Name, y = ROI, group = 1, color = as.factor(Phase))) +
  geom_line(size = 1.2) + 
  geom_point(size = 3) +
  geom_smooth(aes(group = 1), method = "loess", color = "Black", size = 1, linetype = "dashed", se =FALSE) +
  labs(title = "Movies vs ROI",
       x = "Movies",
       y = "ROI",
       color = "Phase") +  # Set the legend title to "Phase"
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 7),  # Rotate x-axis text
    legend.title = element_text(size = 7),                        # Adjust legend title size
    legend.text = element_text(size = 7),                         # Adjust legend text size
    legend.position = c(0, 1),                                    # Top-left legend position
    legend.justification = c(0, 1)                                # Align legend in top-left
  ) +
  scale_color_manual(values = c("cyan", "deepskyblue3", "blue"))   # Custom colors for the phases
print(movies_vs_ROI)
```

-   From a commercial standpoint, Marvel has demonstrated a strong success rate, with most films achieving an ROI of above 300%. Moreover, the mean return on investment has shown a marked upward trend since Phase 1, indicating a significant improvement in financial performance in subsequent phases.

-   Now, we would like to examine how a director's or actor's work was received by both audiences and critics, as well as explore any relationship between the financial success of the movie and the contributions of the directors and actors.

```{r,fig.align='left', fig.width=10, fig.height=4}
MCU_Data <- MCU_Data %>%
  mutate(MainActor = sub(",.*", "", Cast))
##################################################################################
actor_avg_imdb <- MCU_Data %>%
  group_by(MainActor) %>%
  summarise(AvgIMDb = mean(`IMDB Rating`, na.rm = TRUE))

MainActor_vs_IMDb <- ggplot(actor_avg_imdb, aes(x =MainActor, y = AvgIMDb)) +
  geom_bar(stat = "identity", color = "white", size = 0.001, fill = "lightcoral") +
  coord_cartesian(ylim = c(6, 8.5)) +
  labs(
    title = "Main Actor vs. Average IMDb",
    x = "Main Actor",
    y = "Average IMDb") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
##################################################################################
actor_avg_Meta <- MCU_Data %>%
  group_by(MainActor) %>%
  summarise(AvgMeta = mean(`Metascore`, na.rm = TRUE))

MainActor_vs_Meta <- ggplot(actor_avg_Meta, aes(x =MainActor, y = AvgMeta)) +
  geom_bar(stat = "identity", color = "white", size = 0.001, fill = "lightslateblue") +
  coord_cartesian(ylim = c(55, 95)) +
  labs(
    title = "Main Actor vs. Average Metascore",
    x = "Main Actor",
    y = "Average Metascore") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
##################################################################################

grid.arrange(MainActor_vs_IMDb, MainActor_vs_Meta, ncol = 2)
```

- So, we see that Chris Pratt was the audience's favorite, with an average IMDb rating of 7.8, closely followed by Robert Downey Jr., who has an average rating of 7.74. In contrast, critics overwhelmingly preferred Chadwick Boseman, with an average Metascore of 88.

```{r,fig.align='left', fig.width=10, fig.height=4}
MCU_Data <- MCU_Data %>%
  mutate(MainActor = sub(",.*", "", Cast))
###########################################################################################
actor_avg_gross <- MCU_Data %>%
  group_by(MainActor) %>%
  summarise(AverageGross = mean(`Total Gross`))
actor_avg_gross['AverageGross'] = actor_avg_gross['AverageGross']/10^9

MainActor_vs_AvgGross <- ggplot(actor_avg_gross, aes(x = MainActor, y = AverageGross)) +
  geom_bar(stat = "identity", color = "white", size = 0.001, fill = "firebrick2") +
  labs(
    title = "Main Actor vs. Average Gross",
    x = "Main Actor",
    y = "Average Gross in billions") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
############################################################################################
actor_avg_ROI <- MCU_Data %>%
  group_by(MainActor) %>%
  summarise(Average_ROI = mean(`ROI`))

MainActor_vs_Avg_ROI <- ggplot(actor_avg_ROI, aes(x = MainActor, y = Average_ROI)) +
  geom_bar(stat = "identity", color = "white", size = 0.001, fill = "springgreen2") +
  labs(
    title = "Main Actor vs. Average ROI",
    x = "Main Actor",
    y = "Average ROI") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
############################################################################################
#ggplotly(MainActor_vs_Avg_ROI)
grid.arrange(MainActor_vs_AvgGross, MainActor_vs_Avg_ROI, ncol = 2)

##- here we can observe that the actor which brings the highest average Gross was Robert Downey Jr.(1.42Billion).However, Brie Larson was Marvel's best investment with an average return on investment of more than 605% followed by Chadwick Boseman with about 573%.and (1.34Billion)

```

- Here, we can observe that the actor with the highest average gross is Robert Downey Jr. (1.42 billion). However, Brie Larson was Marvel's best investment, achieving an average return on investment of more than 605%. Notably, Chadwick Boseman closely follows both in terms of average gross, with approximately 1.34 billion, and in return on investment, with about 573%.

```{r,fig.align='left', fig.width=10, fig.height=4}
# Calculate average IMDb ratings by director
director_AvgIMDb <- MCU_Data %>%
  group_by(Director) %>%
  summarise(Avg_IMDB_Rating = mean(`IMDB Rating`, na.rm = TRUE))

# Create the IMDb ratings plot
director_vs_AvgIMDb <- ggplot(data = director_AvgIMDb, aes(x = Director, y = Avg_IMDB_Rating, group = 1)) +
  geom_bar(stat = "identity", color = "white", size = 0.001, fill = "darkorchid2") +
  coord_cartesian(ylim = c(6, 8.5)) +
  labs(title = "Average IMDb Ratings VS. Director",
       x = "Director",
       y = "Average IMDb Rating") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(limits = director_AvgIMDb$Director)
############################################################################################################
# Calculate average Metascore by director
director_AvgMeta <- MCU_Data %>%
  group_by(Director) %>%
  summarise(Avg_Metascore = mean(`Metascore`, na.rm = TRUE))

# Create the IMDb ratings plot
director_vs_AvgMeta <- ggplot(data = director_AvgMeta, aes(x = Director, y = Avg_Metascore, group = 1)) +
  geom_bar(stat = "identity", color = "white", size = 0.001, fill = "gold1") +
  coord_cartesian(ylim = c(40, 90)) +
  labs(title = "Average Metascore VS. Director",
       x = "Director",
       y = "Average Metascore") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(limits = director_AvgMeta$Director)
############################################################################################################
# Arrange the two plots side by side
grid.arrange(director_vs_AvgIMDb, director_vs_AvgMeta, nrow = 1)
```
-  We see that the Russo brothers achieved the highest IMDb rating of 8.075, closely followed by Taika Waititi with a rating of 7.9. However, critics highly regarded the work of Ryan Coogler, who received a staggering average Metascore of 88.

-  Now, we would like to understand how correlated the indicators of a film's success, such as IMDb rating and Metascore, are with the film's actual success.

```{r,fig.align='left', fig.width=10, fig.height=4}
Metascore_vs_Oscar_nominations <- ggplot(data = MCU_Data, aes(x = `Metascore`, y = `Oscar Nomination`)) +
  geom_point(col="deepskyblue2") +
  geom_smooth(method = "lm", se = TRUE , color = "blue") +
  labs(title = "Oscar Nominations vs. Metascore",
       x = "Metascore",
       y = "Oscar Nominations") +
  theme_minimal()
###########################################################################################################
IMDb_vs_Oscar_nominations <- ggplot(data = MCU_Data, aes(x = `IMDB Rating`, y = `Oscar Nomination`)) +
  geom_point(col="springgreen") +
  geom_smooth(method = "lm", se = TRUE , color = "green4") +
  labs(title = "Oscar Nominations vs IMDB Rating",
       x = "IMDB Rating",
       y = "Oscar Nominations") +
  theme_minimal()
###########################################################################################################
grid.arrange(Metascore_vs_Oscar_nominations, IMDb_vs_Oscar_nominations,ncol=2)
```
- We can observe that Metascore and Oscar nominations are significantly positively correlated; however, IMDb ratings and Oscar nominations are not. This suggests that Metascore is a much better indicator of a movie's likelihood of being nominated for an Oscar and subsequently winning it.

```{r,fig.align='left', fig.width=10, fig.height=4}
MCU_Data$`Total Gross`= MCU_Data$`Total Gross`/10^9 
IMDb_vs_Total_Gross<- ggplot(data = MCU_Data, aes(x = `IMDB Rating`, y = `Total Gross`)) +
  geom_point(col="orchid2") +
  geom_smooth(method = "lm", se = TRUE, color = "darkorchid4") +
  labs(title = "IMDb Ratings vs Total Gross",
       x = "IMDB Rating",
       y = "Total Gross in billions") +
  theme_minimal()
###########################################################################################################
MCU_Data$Budget=MCU_Data$Budget/10^9
ROI_vs_Budget<-ggplot(data = MCU_Data, aes(x = `Budget`, y = `ROI`)) +
  geom_point(col="red2") +
  geom_smooth(method = "lm", se = TRUE, color = "red4") +
  labs(title = "ROI vs Budget",
       x = "Budget in billions",
       y = "ROI") +
  theme_minimal()
###########################################################################################################
grid.arrange(IMDb_vs_Total_Gross,ROI_vs_Budget,ncol=2)
```

-  We can see that IMDb ratings and the total gross revenue generated by the movies are closely correlated, indicating that a good IMDb rating tends to lead to higher revenue generation.
-  There is a very high positive correlation between budget and ROI, suggesting that movies with a higher budget tend to have a higher return on investment. However, some outliers cause the error to increase when the budget exceeds $0.3 billion.

## Correlation Heatmap:

```{r,fig.align='center', fig.width=10, fig.height=4}
heatmap_data <- MCU_Data[, c("IMDB Rating", "Budget", "Total Gross", "ROI", "Oscar Nomination","Opening Gross","Metascore")]

correlation_matrix <- cor(heatmap_data)

corrplot(correlation_matrix,
         method = "square",
         tl.col = "black",
         addCoef.col ='black',
         tl.srt = 45,
         order='AOE',
         type='upper',
         col = COL2('RdYlBu',100),
         diag = TRUE )
```

## Results:
- Analyzing the trends in IMDb ratings and ROI, it is evident that Marvel has a robust track record of critical acclaim, with the lowest IMDb rating being 6.6. Furthermore, the franchise has never recorded a negative return on investment. Instead most of the ROI's are above 300% and there is a steady increasing trend in the ROI.

- Based on the average IMDb ratings of the films, Chris Pratt emerged as the audience's favorite, closely followed by Robert Downey Jr. However, critics favored Chadwick Boseman, who received a Metascore of 88.

- In terms of commercial success, the actor with the highest average gross is Robert Downey Jr. (1.42 billion). Brie Larson proved to be Marvelâ€™s best investment, achieving an average return on investment of over 605%. Notably, Chadwick Boseman closely follows in both average gross, with approximately 1.34 billion, and return on investment, with about 573%.

- The Russo brothers achieved the highest IMDb rating of 8.075, closely followed by Taika Waititi with a rating of 7.9. In contrast, critics highly regarded the work of Ryan Coogler with 'Black Panther', who received a Metascore of 88.

- There is a strong correlation between IMDb ratings and the total gross revenue generated by the films, indicating that a high IMDb rating tends to lead to increased revenue.

- We can observe that Metascore and Oscar nominations are significantly positively correlated; however, IMDb ratings and Oscar nominations are not. This suggests that Metascore is a much better indicator of a movie's likelihood of being nominated for an Oscar and subsequently winning it.

- While budget and ROI show a positive correlation, some outliers exist, such as *Spider-Man: Far From Home*, which boasts a high ROI despite a comparatively lower budget. This pattern is often observed in films with lower budgets but higher gross earnings.

- Consequently, even though *Avengers: Endgame* is the highest-grossing film, its ROI does not significantly exceed that of *Spider-Man: Far From Home* due to its higher budget. Overall, there is a substantial positive correlation between budget and ROI, suggesting that films with larger budgets tend to yield higher returns on investment.


